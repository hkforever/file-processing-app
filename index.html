<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…ƒæ°”æ£®æ— X ä¸œåå…„å¼Ÿ è®¢å•è½¬æ¢å·¥å…· - æœ¬åœ°æµ‹è¯•ç‰ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }
        .upload-area.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .processing-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .debug-info {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 12px;
            margin: 16px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useRef } = React;

        // ç§»é™¤æ•°å­—çš„è¾…åŠ©å‡½æ•°
        const removeNumbers = (str) => {
            if (!str) return '';
            return str.replace(/\d+/g, '').trim();
        };

        // æ–‡ä»¶å¤„ç†å‡½æ•°
        const readOrderFile = async (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const sheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[sheetName];
                        const jsonData = XLSX.utils.sheet_to_json(worksheet);
                        
                        console.log('ğŸ“Š åŸå§‹æ•°æ®æ ·æœ¬:', jsonData.slice(0, 2));
                        
                        if (jsonData.length === 0) {
                            reject(new Error('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®æˆ–æ²¡æœ‰æ•°æ®'));
                            return;
                        }
                        
                        // éªŒè¯å¿…è¦å­—æ®µ
                        const requiredFields = ['è®¢å•ç¼–ç ', 'ç½‘ç‚¹ç¼–ç ', 'ç½‘ç‚¹åç§°', 'å•†å“ç¼–ç ', 'å•†å“åç§°', 'é”€å”®å•ä»·(å…ƒ)'];
                        const hasRequiredFields = requiredFields.every(field => field in jsonData[0]);
                        
                        if (!hasRequiredFields) {
                            console.log('âŒ ç¼ºå°‘å­—æ®µ:', requiredFields.filter(field => !(field in jsonData[0])));
                            console.log('ğŸ“‹ å®é™…å­—æ®µ:', Object.keys(jsonData[0]));
                            reject(new Error('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼Œç¼ºå°‘å¿…è¦çš„è®¢å•å­—æ®µï¼ˆè®¢å•ç¼–ç ã€ç½‘ç‚¹ç¼–ç ã€ç½‘ç‚¹åç§°ã€å•†å“ç¼–ç ã€å•†å“åç§°ã€é”€å”®å•ä»·ï¼‰'));
                            return;
                        }
                        
                        resolve(jsonData);
                    } catch (error) {
                        reject(new Error('æ–‡ä»¶è¯»å–å¤±è´¥: ' + error.message));
                    }
                };
                reader.onerror = () => reject(new Error('æ–‡ä»¶è¯»å–å¤±è´¥'));
                reader.readAsArrayBuffer(file);
            });
        };

        const transformOrderData = (orderData) => {
            console.log('ğŸ”„ å¼€å§‹è½¬æ¢æ•°æ®ï¼Œå…±', orderData.length, 'æ¡è®°å½•');
            
            return orderData.map((order, index) => {
                // åˆ¤æ–­æ˜¯å¦ä¸ºèµ å“ï¼ˆæ ¹æ®å•†å“ç±»å‹åˆ¤æ–­ï¼‰
                const æ˜¯å¦èµ å“ = ["å¸¸è§„èµ å“", "æ´»åŠ¨èµ å“", "è´¹ç”¨å…‘æ¢å“"].includes(order.å•†å“ç±»å‹) ? "æ˜¯" : "";
                
                // è°ƒè¯•ï¼šæ£€æŸ¥é”€å”®å•ä»·å­—æ®µ
                const originalPrice = order["é”€å”®å•ä»·(å…ƒ)"];
                console.log(`ğŸ“ ç¬¬${index + 1}æ¡è®°å½• - åŸå§‹é”€å”®å•ä»·:`, originalPrice, 'ç±»å‹:', typeof originalPrice);
                
                // åˆ›å»ºè½¬æ¢åçš„æ•°æ®å¯¹è±¡ï¼Œä¸¥æ ¼æŒ‰ç…§åŸé¡¹ç›®çš„å­—æ®µæ˜ å°„
                const transformedData = {
                    // ä¿ç•™åŸå§‹è®¢å•æ•°æ®çš„æ‰€æœ‰å­—æ®µ
                    ...order,
                    
                    // æ·»åŠ è½¬æ¢åçš„å­—æ®µï¼ˆæŒ‰ç…§å¯¼å‡ºæ¨¡æ¿çš„å­—æ®µé¡ºåºï¼‰
                    å‚ç¼–: order.ç½‘ç‚¹ç¼–ç  || '',
                    è´§å·: order.å•†å“ç¼–ç  || '',
                    "Q7å¹³å°ç»é”€å•†": "",
                    ä¸šåŠ¡å‘˜: removeNumbers(order.ä¸šåŠ¡è´Ÿè´£äºº || ''),
                    "ä¸šåŠ¡ç±»å‹": "",
                    "ä¸»è¡¨å¤‡æ³¨": order.å¯¼å…¥å¤‡æ³¨ || order.å¤‡æ³¨ || '',
                    ä»“åº“: "ä¼ ç»Ÿä»“",
                    "ä»˜æ¬¾æ–¹å¼": "",
                    å•ä»·: "",
                    å•æ®å•ä½: order.å•ä½ || '',
                    "å•æ®å•ä½å•ä»·": (() => {
                        const price = order["é”€å”®å•ä»·(å…ƒ)"];
                        if (price === undefined || price === null || price === '') {
                            console.log(`âš ï¸  ç¬¬${index + 1}æ¡è®°å½• - é”€å”®å•ä»·ä¸ºç©ºï¼Œè®¾ç½®ä¸º0`);
                            return 0;
                        }
                        const numPrice = Number(price);
                        const result = isNaN(numPrice) ? 0 : numPrice;
                        console.log(`âœ… ç¬¬${index + 1}æ¡è®°å½• - é”€å”®å•ä»·è½¬æ¢: ${price} â†’ ${result}`);
                        return result;
                    })(),
                    å•æ®å•ä½æ•°é‡: (() => {
                        const quantity = order.é”€å”®æ•°é‡;
                        if (quantity === undefined || quantity === null || quantity === '') {
                            return 0;
                        }
                        const numQuantity = Number(quantity);
                        return isNaN(numQuantity) ? 0 : numQuantity;
                    })(),
                    "å•æ®ç±»å‹": "",
                    "å‘è´§åœ°å€": "",
                    å¤‡æ³¨: "",
                    "å®¢æˆ·æ”¶è´§æ—¥æœŸ": "",
                    "å®¢æˆ·è®¢å•å·": order.è®¢å•ç¼–ç  || '',
                    åº—å·: "",
                    æ‰¹å·: "",
                    æ•°é‡: "",
                    æ˜¯å¦èµ å“,
                    ç†è´§å‘˜: "",
                    "é”€å”®å•å·": "",
                    "é”€å”®æ—¥æœŸ": "",
                    "é¢„è®¡å¼€ç¥¨æ—¥": "",
                    "é¢„è®¢è´§ç¼–å·": ""
                };
                
                return transformedData;
            });
        };

        const generateExportFile = (data) => {
            try {
                console.log('ğŸ“¤ å¼€å§‹ç”Ÿæˆå¯¼å‡ºæ–‡ä»¶ï¼Œæ•°æ®æ¡æ•°:', data.length);
                
                // å¯¼å‡ºå­—æ®µé¡ºåºï¼Œä¸¥æ ¼æŒ‰ç…§åŸé¡¹ç›®çš„å¯¼å‡ºæ¨¡æ¿
                const exportColumns = [
                    "å‚ç¼–", "è´§å·", "Q7å¹³å°ç»é”€å•†", "ä¸šåŠ¡å‘˜", "ä¸šåŠ¡ç±»å‹", "ä¸»è¡¨å¤‡æ³¨", 
                    "ä»“åº“", "ä»˜æ¬¾æ–¹å¼", "å•ä»·", "å•æ®å•ä½", "å•æ®å•ä½å•ä»·", "å•æ®å•ä½æ•°é‡", 
                    "å•æ®ç±»å‹", "å‘è´§åœ°å€", "å¤‡æ³¨", "å®¢æˆ·æ”¶è´§æ—¥æœŸ", "å®¢æˆ·è®¢å•å·", "åº—å·", 
                    "æ‰¹å·", "æ•°é‡", "æ˜¯å¦èµ å“", "ç†è´§å‘˜", "é”€å”®å•å·", "é”€å”®æ—¥æœŸ", 
                    "é¢„è®¡å¼€ç¥¨æ—¥", "é¢„è®¢è´§ç¼–å·"
                ];
                
                // åªæå–éœ€è¦å¯¼å‡ºçš„å­—æ®µï¼Œè¿‡æ»¤æ‰åŸå§‹ä¸Šä¼ æ•°æ®çš„å­—æ®µ
                const filteredData = data.map((item, index) => {
                    const exportItem = {};
                    exportColumns.forEach(column => {
                        // å¯¹äºæ•°å€¼å­—æ®µï¼Œç¡®ä¿0å€¼ä¸è¢«è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²
                        if (column === "å•æ®å•ä½å•ä»·" || column === "å•æ®å•ä½æ•°é‡") {
                            const value = item[column];
                            if (value === undefined || value === null || value === '') {
                                exportItem[column] = 0;
                                console.log(`ğŸ”§ ç¬¬${index + 1}æ¡è®°å½• - ${column}å­—æ®µä¸ºç©ºï¼Œè®¾ç½®ä¸º0`);
                            } else {
                                const numValue = Number(value);
                                exportItem[column] = isNaN(numValue) ? 0 : numValue;
                                console.log(`âœ… ç¬¬${index + 1}æ¡è®°å½• - ${column}å­—æ®µ: ${value} â†’ ${exportItem[column]}`);
                            }
                        } else {
                            exportItem[column] = item[column] || '';
                        }
                    });
                    return exportItem;
                });
                
                console.log('ğŸ“‹ å¯¼å‡ºæ•°æ®æ ·æœ¬:', filteredData.slice(0, 2));
                
                // åˆ›å»ºå·¥ä½œç°¿å’Œå·¥ä½œè¡¨ï¼ŒæŒ‡å®šåˆ—é¡ºåº
                const worksheet = XLSX.utils.json_to_sheet(filteredData, { header: exportColumns });
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Converted Orders');
                
                const excelBuffer = XLSX.write(workbook, { bookType: 'xls', type: 'array' });
                const blob = new Blob([excelBuffer], { type: 'application/vnd.ms-excel' });
                return URL.createObjectURL(blob);
            } catch (error) {
                console.error('âŒ æ–‡ä»¶ç”Ÿæˆå¤±è´¥:', error);
                throw new Error('æ–‡ä»¶ç”Ÿæˆå¤±è´¥: ' + error.message);
            }
        };

        // æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
        const FileUpload = ({ onFileUpload, disabled }) => {
            const [isDragOver, setIsDragOver] = useState(false);
            const fileInputRef = useRef(null);

            const handleDragOver = useCallback((e) => {
                e.preventDefault();
                setIsDragOver(true);
            }, []);

            const handleDragLeave = useCallback((e) => {
                e.preventDefault();
                setIsDragOver(false);
            }, []);

            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragOver(false);
                
                const files = Array.from(e.dataTransfer.files);
                const validFile = files.find(file => 
                    file.type.includes('sheet') || 
                    file.type.includes('excel') || 
                    file.name.endsWith('.xlsx') || 
                    file.name.endsWith('.xls') || 
                    file.name.endsWith('.csv')
                );
                
                if (validFile) {
                    onFileUpload(validFile);
                } else {
                    alert('è¯·ä¸Šä¼ Excelæˆ–CSVæ–‡ä»¶');
                }
            }, [onFileUpload]);

            const handleFileSelect = (e) => {
                const file = e.target.files[0];
                if (file) {
                    onFileUpload(file);
                }
            };

            return (
                <div className="mb-8">
                    <div
                        className={`upload-area p-8 rounded-xl text-center cursor-pointer ${isDragOver ? 'dragover' : ''} ${disabled ? 'opacity-50 cursor-not-allowed' : ''}`}
                        onDragOver={handleDragOver}
                        onDragLeave={handleDragLeave}
                        onDrop={handleDrop}
                        onClick={() => !disabled && fileInputRef.current?.click()}
                    >
                        <div className="flex flex-col items-center space-y-4">
                            <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
                                <i className="fa-solid fa-cloud-upload-alt text-blue-600 text-2xl"></i>
                            </div>
                            <div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">ä¸Šä¼ è®¢å•æ–‡ä»¶</h3>
                                <p className="text-gray-600">
                                    æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
                                </p>
                                <p className="text-sm text-gray-500 mt-2">
                                    æ”¯æŒ .xlsx, .xls, .csv æ ¼å¼
                                </p>
                            </div>
                        </div>
                        <input
                            ref={fileInputRef}
                            type="file"
                            accept=".xlsx,.xls,.csv"
                            onChange={handleFileSelect}
                            className="hidden"
                            disabled={disabled}
                        />
                    </div>
                </div>
            );
        };

        // å¤„ç†çŠ¶æ€ç»„ä»¶
        const ProcessingStatus = ({ status, message }) => {
            if (status === 'idle') return null;

            const getStatusContent = () => {
                switch (status) {
                    case 'processing':
                        return (
                            <div className="flex flex-col items-center space-y-4">
                                <div className="w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full processing-spinner"></div>
                                <p className="text-gray-700">æ­£åœ¨å¤„ç†è®¢å•æ•°æ®...</p>
                            </div>
                        );
                    case 'success':
                        return (
                            <div className="flex flex-col items-center space-y-4">
                                <div className="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center">
                                    <i className="fa-solid fa-check text-green-600 text-2xl"></i>
                                </div>
                                <p className="text-gray-700">å¤„ç†å®Œæˆï¼</p>
                            </div>
                        );
                    case 'error':
                        return (
                            <div className="flex flex-col items-center space-y-4">
                                <div className="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center">
                                    <i className="fa-solid fa-exclamation text-red-600 text-2xl"></i>
                                </div>
                                <p className="text-gray-700">{message || 'å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯'}</p>
                            </div>
                        );
                    default:
                        return null;
                }
            };

            const bgColor = status === 'processing' ? 'bg-blue-50 border-blue-200' :
                           status === 'success' ? 'bg-green-50 border-green-200' :
                           status === 'error' ? 'bg-red-50 border-red-200' : 'bg-gray-50 border-gray-200';

            return (
                <div className={`w-full mt-8 p-8 rounded-xl border ${bgColor} flex flex-col items-center justify-center fade-in`}>
                    {getStatusContent()}
                </div>
            );
        };

        // è®¢å•é¢„è§ˆç»„ä»¶
        const OrderPreview = ({ data }) => {
            if (!data || data.length === 0) return null;

            const displayData = data.slice(0, 5); // åªæ˜¾ç¤ºå‰5æ¡
            
            // æ˜¾ç¤ºè½¬æ¢åçš„å­—æ®µ
            const previewColumns = [
                "å‚ç¼–", "è´§å·", "Q7å¹³å°ç»é”€å•†", "ä¸šåŠ¡å‘˜", "ä¸šåŠ¡ç±»å‹", "ä¸»è¡¨å¤‡æ³¨", 
                "ä»“åº“", "ä»˜æ¬¾æ–¹å¼", "å•ä»·", "å•æ®å•ä½", "å•æ®å•ä½å•ä»·", "å•æ®å•ä½æ•°é‡", 
                "å•æ®ç±»å‹", "å‘è´§åœ°å€", "å¤‡æ³¨", "å®¢æˆ·æ”¶è´§æ—¥æœŸ", "å®¢æˆ·è®¢å•å·", "åº—å·", 
                "æ‰¹å·", "æ•°é‡", "æ˜¯å¦èµ å“", "ç†è´§å‘˜", "é”€å”®å•å·", "é”€å”®æ—¥æœŸ", 
                "é¢„è®¡å¼€ç¥¨æ—¥", "é¢„è®¢è´§ç¼–å·"
            ];

            return (
                <div className="mt-8 fade-in">
                    <h3 className="text-lg font-medium text-gray-900 mb-4">è½¬æ¢åæ•°æ®é¢„è§ˆ (æ˜¾ç¤ºå‰5æ¡)</h3>
                    
                    {/* è°ƒè¯•ä¿¡æ¯ */}
                    <div className="debug-info">
                        <strong>ğŸ” è°ƒè¯•ä¿¡æ¯:</strong><br/>
                        æ€»è®°å½•æ•°: {data.length}<br/>
                        é¢„è§ˆè®°å½•æ•°: {displayData.length}<br/>
                        å•æ®å•ä½å•ä»·å­—æ®µå€¼: {displayData.map((row, i) => `ç¬¬${i+1}æ¡: ${row["å•æ®å•ä½å•ä»·"]}`).join(', ')}
                    </div>
                    
                    <div className="overflow-x-auto">
                        <table className="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead className="bg-gray-50">
                                <tr>
                                    {previewColumns.map((key) => (
                                        <th key={key} className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">
                                            {key}
                                        </th>
                                    ))}
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200">
                                {displayData.map((row, index) => (
                                    <tr key={index} className="hover:bg-gray-50">
                                        {previewColumns.map((column, cellIndex) => (
                                            <td key={cellIndex} className="px-4 py-3 text-sm text-gray-900 border-b">
                                                {(() => {
                                                    if (column === "å•æ®å•ä½å•ä»·" || column === "å•æ®å•ä½æ•°é‡") {
                                                        const value = row[column];
                                                        if (value === undefined || value === null || value === '') {
                                                            return '0';
                                                        }
                                                        const numValue = Number(value);
                                                        return String(isNaN(numValue) ? 0 : numValue);
                                                    } else {
                                                        return String(row[column] || '');
                                                    }
                                                })()}
                                            </td>
                                        ))}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                    <p className="text-sm text-gray-500 mt-2">
                        å…±å¤„ç† {data.length} æ¡è®¢å•æ•°æ®
                    </p>
                </div>
            );
        };

        // æ–‡ä»¶ä¸‹è½½ç»„ä»¶
        const FileDownload = ({ fileName, fileUrl, disabled, onDownload }) => {
            if (!fileUrl || disabled) return null;

            return (
                <div className="w-full mt-8 flex justify-center fade-in">
                    <div className="flex flex-col items-center">
                        <button
                            onClick={onDownload}
                            className="px-8 py-4 rounded-lg font-medium transition-all duration-300 flex items-center space-x-2 bg-green-500 text-white hover:bg-green-600 shadow-lg hover:shadow-xl"
                        >
                            <i className="fa-solid fa-download mr-2"></i>
                            <span>ä¸‹è½½è½¬æ¢åçš„æ–‡ä»¶</span>
                        </button>
                        <p className="text-xs text-gray-500 mt-2 text-center">
                            æ–‡ä»¶å: {fileName}
                        </p>
                    </div>
                </div>
            );
        };

        // ä¸»åº”ç”¨ç»„ä»¶
        const App = () => {
            const [uploadedFile, setUploadedFile] = useState(null);
            const [processingStatus, setProcessingStatus] = useState('idle');
            const [processedData, setProcessedData] = useState([]);
            const [exportFileUrl, setExportFileUrl] = useState(null);
            const [errorMessage, setErrorMessage] = useState(null);

            const handleFileUpload = async (file) => {
                console.log('ğŸ“ å¼€å§‹å¤„ç†æ–‡ä»¶:', file.name);
                setUploadedFile(file);
                setProcessingStatus('processing');
                setErrorMessage(null);

                try {
                    // è¯»å–è®¢å•æ–‡ä»¶
                    const orderData = await readOrderFile(file);
                    console.log('âœ… æ–‡ä»¶è¯»å–æˆåŠŸï¼Œè®°å½•æ•°:', orderData.length);

                    if (orderData.length === 0) {
                        setProcessingStatus('error');
                        setErrorMessage('æ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ°è®¢å•æ•°æ®');
                        return;
                    }

                    // è½¬æ¢è®¢å•æ•°æ®
                    const transformedData = transformOrderData(orderData);
                    console.log('âœ… æ•°æ®è½¬æ¢å®Œæˆ');
                    setProcessedData(transformedData);

                    // ç”Ÿæˆå¯¼å‡ºæ–‡ä»¶
                    const fileUrl = generateExportFile(transformedData);
                    console.log('âœ… å¯¼å‡ºæ–‡ä»¶ç”Ÿæˆå®Œæˆ');
                    setExportFileUrl(fileUrl);

                    // æ›´æ–°çŠ¶æ€
                    setProcessingStatus('success');
                } catch (error) {
                    console.error('âŒ å¤„ç†å¤±è´¥:', error);
                    setProcessingStatus('error');
                    setErrorMessage(error.message);
                }
            };

            const handleDownload = () => {
                if (!exportFileUrl || !uploadedFile) {
                    console.log('âŒ æ²¡æœ‰å¯ä¸‹è½½çš„æ–‡ä»¶');
                    return;
                }

                try {
                    const originalName = uploadedFile.name.replace(/\.(xlsx|xls|csv)$/i, '');
                    const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '');
                    const downloadFileName = `converted_${originalName}_${timestamp}.xls`;

                    const a = document.createElement('a');
                    a.href = exportFileUrl;
                    a.download = downloadFileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);

                    console.log('âœ… æ–‡ä»¶ä¸‹è½½å¼€å§‹:', downloadFileName);
                } catch (error) {
                    console.error('âŒ ä¸‹è½½å¤±è´¥:', error);
                }
            };

            return (
                <div className="min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
                    <div className="max-w-4xl mx-auto">
                        {/* é¡µé¢æ ‡é¢˜ */}
                        <div className="text-center mb-12">
                            <h1 className="text-4xl font-bold text-gray-900 mb-4">
                                å…ƒæ°”æ£®æ— X ä¸œåå…„å¼Ÿ è®¢å•è½¬æ¢å·¥å…·
                            </h1>
                            <p className="text-xl text-gray-600 max-w-2xl mx-auto">
                                è¯·ä»æ±‡è´¢èµ‹Â·ç»é”€å•†ç«¯åå°Â·å…ƒæ°”é”€å”®å‡ºåº“å·²å‘è´§ä¸­å¯¼å‡ºè®¢å•å†…å®¹ï¼Œå†é€šè¿‡æœ¬ç½‘ç«™è½¬åŒ–å¯¼å‡ºè®¢å•å†…å®¹
                            </p>

                        </div>

                        {/* ä¸»è¦å†…å®¹åŒº */}
                        <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
                            <div className="p-8">
                                {/* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */}
                                <FileUpload
                                    onFileUpload={handleFileUpload}
                                    disabled={processingStatus === 'processing'}
                                />

                                {/* å¤„ç†çŠ¶æ€æ˜¾ç¤º */}
                                <ProcessingStatus
                                    status={processingStatus}
                                    message={errorMessage}
                                />

                                {/* è®¢å•é¢„è§ˆåŒºåŸŸ */}
                                <OrderPreview data={processedData} />

                                {/* ä¸‹è½½åŒºåŸŸ */}
                                <FileDownload
                                    fileName={uploadedFile ? `converted_${uploadedFile.name.replace(/\.(xlsx|xls|csv)$/i, '.xls')}` : 'orders.xls'}
                                    fileUrl={exportFileUrl}
                                    disabled={processingStatus !== 'success'}
                                    onDownload={handleDownload}
                                />
                            </div>
                        </div>

                        {/* åŠŸèƒ½è¯´æ˜ */}
                        <div className="mt-12 grid md:grid-cols-3 gap-6">
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <div className="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
                                    <i className="fa-solid fa-upload text-blue-600 text-xl"></i>
                                </div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">ä¸Šä¼ è®¢å•</h3>
                                <p className="text-gray-600">ä¸Šä¼ åŒ…å«è®¢å•æ•°æ®çš„Excelæˆ–CSVæ–‡ä»¶ï¼Œç³»ç»Ÿæ”¯æŒæ ‡å‡†å¯¼å…¥æ¨¡æ¿æ ¼å¼ã€‚</p>
                            </div>

                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <div className="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
                                    <i className="fa-solid fa-magic text-purple-600 text-xl"></i>
                                </div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">è‡ªåŠ¨è½¬æ¢</h3>
                                <p className="text-gray-600">ç³»ç»Ÿè‡ªåŠ¨å¤„ç†è®¢å•æ•°æ®ï¼Œåº”ç”¨é¢„è®¾çš„è½¬æ¢è§„åˆ™ï¼Œç”Ÿæˆæ ‡å‡†å¯¼å‡ºæ ¼å¼ã€‚</p>
                            </div>

                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <div className="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4">
                                    <i className="fa-solid fa-download text-green-600 text-xl"></i>
                                </div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">ä¸‹è½½ç»“æœ</h3>
                                <p className="text-gray-600">å¤„ç†å®Œæˆåï¼Œä¸‹è½½è½¬æ¢åçš„è®¢å•æ–‡ä»¶ï¼Œå¯ç›´æ¥ç”¨äºåç»­ä¸šåŠ¡ç³»ç»Ÿå¯¼å…¥ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // æ¸²æŸ“åº”ç”¨
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>